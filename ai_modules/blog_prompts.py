from typing import Dict

class BlogPrompts:
    CATEGORY_GUIDELINES = {
        '정치': "정치적 사안의 핵심 쟁점을 명확히 짚어주고, 양측의 입장을 균형 있게 다루며, 정책이 실제 시민들에게 미칠 영향을 중심으로 분석해주세요.",
        '경제': "어려운 경제 용어나 지표를 일반인의 눈높이에서 쉽게 풀어 설명하고, 국내외 시장 동향과 연관 지어 실질적인 투자나 소비 관점의 인사이트를 제공해주세요.",
        '사회': "사건의 단순 전달을 넘어, 그 이면에 있는 사회 구조적 문제나 배경을 심층적으로 분석하고, 다양한 세대와 계층의 목소리를 담아주세요.",
        '전체': "해당 이슈의 핵심 정보를 빠르고 정확하게 전달하되, 독자가 스스로 생각해 볼 수 있는 의미 있는 질문이나 화두를 던져주세요."
    }

    @classmethod
    def get_blog_prompt(cls, news_item: Dict, additional_info: str = "") -> str:
        title = news_item.get('title', '제목 없음')
        description = news_item.get('description', '')
        category = news_item.get('category', '일반')
        category_guide = cls.CATEGORY_GUIDELINES.get(category, cls.CATEGORY_GUIDELINES['전체'])

        return f"""
        # **명령 (Role)**
        당신은 15년차 IT 전문 블로거이자 SEO 전문가입니다. 당신의 글은 항상 논리적이고, 독자의 흥미를 유발하며, 검색 엔진에 최적화되어 있습니다.
        당신의 주 독자층은 최신 IT 기술과 트렌드에 관심이 많은 20-30대 직장인입니다.

        # **미션 (Mission)**
        아래에 제공되는 '뉴스 정보'와 '추가 배경 정보'를 바탕으로, 독자들이 끝까지 읽고 싶어 하는 고품질 블로그 포스팅 1개를 작성하세요.

        ---

        # **정보 (Context)**

        ## 📰 뉴스 정보
        - **제목**: {title}
        - **카테고리**: {category}
        - **요약**: {description}

        ## 🔍 추가 배경 정보
        {additional_info}

        ---

        # **작성 지침 (Instructions)**

        ## 1. 제목 (Title)
        - 30~50자 사이로 작성하세요.
        - 독자의 호기심을 자극하는 강력한 헤드라인이어야 합니다.
        - 뉴스 제목을 그대로 사용하지 말고, 독자에게 어떤 가치를 줄 수 있는지 명확히 보여주는 키워드를 포함하세요. (예: '...핵심 기능 총정리', '...논란의 이유 3가지')

        ## 2. 본문 (Content)
        - 전체 2,500자 내외로 작성하세요.
        - 전문적이면서도 독자가 이해하기 쉬운 설명조의 문체를 사용하세요.
        - **[서론]**: 독자의 공감을 사거나 흥미로운 질문을 던지며 시작하세요. 이 글을 왜 읽어야 하는지 명확한 이유를 제시하세요.
        - **[본론]**: 여러 개의 소제목(##)으로 단락을 나누어 가독성을 높이세요. 뉴스의 핵심 내용을 깊이 있게 분석하고, {category_guide} 지침을 반드시 따르세요.
        - **[이미지 마커]**: 본문의 가장 중요한 두 지점에 `[이미지_1]`과 `[이미지_2]` 마커를 삽입하여 이미지 들어갈 위치를 명확히 표시하세요.

        ## 3. 결론 (Conclusion)
        - 200자 내외로 본문 내용을 핵심적으로 요약하세요.
        - 독자에게 행동을 유도하거나(예: 댓글 토론 유도), 미래 전망을 제시하며 마무리하세요.

        ## 4. 이미지 키워드 (Image Keywords)
        - `image_keywords` 항목에는 무료 이미지 사이트에서 검색할 **구체적인 영어 키워드** 2개를 배열 형태로 제공해야 합니다.
        - 추상적인 단어(예: 'future', 'technology') 대신, 포스팅의 핵심 내용을 시각적으로 보여줄 수 있는 구체적인 장면이나 사물을 묘사하세요. (예: 'server room with blue lights', 'person typing on futuristic laptop')

        ## 5. 태그 (Tags)
        - `tags` 항목에는 검색량과 관련성을 고려하여 5~8개의 태그를 배열 형태로 제공하세요.
        - 핵심 키워드, 연관 키워드, 트렌드 키워드를 조합하여 SEO 효과를 극대화하세요.

        ---

        # **주의사항 (Constraints)**
        - 절대로 뉴스 기사의 문장을 그대로 복사해서 사용하지 마세요. 당신의 관점에서 재해석하고 분석해야 합니다.
        - 독자가 어려워할 만한 전문 용어는 사용을 피하거나, 반드시 쉽게 풀어서 설명해주세요.
        - 응답은 반드시 아래에 명시된 **JSON 출력 형식**을 따라야 하며, 다른 어떤 텍스트도 추가해서는 안 됩니다.

        ---

        # **JSON 출력 형식 (Output Format)**
        ```json
        {{
          "title": "여기에 SEO에 최적화된 매력적인 제목을 작성",
          "content": "## 흥미로운 서론\\n\\n서론 내용...\\n\\n[이미지_1]\\n\\n## 핵심 분석 1\\n\\n본론 내용...\\n\\n## 전망과 과제\\n\\n[이미지_2]\\n\\n본론 내용...",
          "conclusion": "여기에 본문을 요약하고 독자의 행동을 유도하는 결론을 작성",
          "image_keywords": ["specific English keyword 1", "descriptive English keyword 2"],
          "tags": ["#핵심태그", "#관련태그", "#블로그", "#AI", "#자동화"]
        }}
        ```
        """

    @classmethod
    def get_context_template(cls, category: str, search_query: str) -> str:
        templates = {
            '정치': f"최근 정치권에서는 '{search_query}' 관련 논의가 활발히 진행되고 있으며, 여야 간 입장 차이가 뚜렷합니다.",
            '경제': f"'{search_query}' 이슈는 국내 경제와 시장에 미치는 영향이 클 것으로 전망되며, 전문가들의 의견이 분분합니다.",
            '사회': f"'{search_query}' 사안에 대해 시민사회와 각계각층에서 다양한 의견과 대안이 제시되고 있습니다.",
            '전체': f"'{search_query}' 관련하여 다방면에서 관심이 집중되고 있으며, 향후 전개 과정이 주목받고 있습니다."
        }
        return templates.get(category, templates['전체'])